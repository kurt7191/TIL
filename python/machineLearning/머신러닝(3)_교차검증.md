# 교차검증



train 데이터에는 타겟과 데이터가 혼합되어 있음

train 데이터를 가지고 모델을 학습시키고, train 데이터의 target 데이터로 모델을 평가하게 되면 과적합이 발생한다. 

따라서 분리를 해서 모델을 학습시키고 평가를 하는데, 그럼에도 불구하고 과적합의 위험이 있을 수 있다.



이때 사용되는 게 교차검증



### 0.데이터 로드



```python
import seaborn as sns

mpg = sns.load_dataset('mpg')
```



seaborn 에 있는 mpg 데이터 셋을 로딩한다.



### 1. 데이터 탐색



##### 1.1 데이터 구조 파악 및 null 값 제거



```python
mpg.info()
mpg.dropna()
```



데이터의 자료구조와 null 값을 파악한다.

null 값이 있는 행을 제거할 때 `dropna` 함수를 사용한다.

단, 본래는 이렇게 함부로 제거하면 안된다. 데이터를 잘 살펴보고 대체할 수 있으면 대체하고 할 수 없으면 지워야 한다.



##### missingno 를 통해서 null 값 확인

시각화를 통해서 확인



`missingno.matrix()` 



```python
#널값이 있는 부분은 흰줄로 나타남
import matplotlib.pyplot as plt
missingno.matrix(mpg)
plt.savefig('missingno_matrix')
```



![missingno_matrix](C:/study/workspace_python/MachineLearning/missingno_matrix.png)



`missingno.bar()` 를 사용하기



```python
missingno.bar(mpg)
plt.savefig('missingno_bar')
```



![missingno_bar](C:/study/workspace_python/MachineLearning/missingno_bar.png)



차이가 잘 나타나지 않기 때문에 y축 값을 조정해서 살펴보기



```python
missingno.bar(mpg)

plt.ylim((.9,1))
plt.savefig('missingno_bar2')
```



![missingno_bar2](C:/study/workspace_python/MachineLearning/missingno_bar2.png)



