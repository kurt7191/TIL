# 머신러닝(2)



> 머신러닝 과정을 이해해보기
>
> 머신러닝의 기초단계



### 데이터 로드



```python
from sklearn.datasets import load_breast_cancer
import pandas as pd
import numpy as np

data_cancer = load_breast_cancer()
print(dir(data_cancer))
print(data_cancer.DESCR)

```



사이킷런 유방암 데이터셋 불러오기



### 데이터 탐색

##### 1. 데이터 프레임 만들기

```python
#훈련데이터로 데이터 프레임 만들기
data_pd = pd.DataFrame(data = data_cancer.data, columns = data_cancer.feature_names)
data_pd.head()

#타겟데이터를 꺼내고 concat 으로 타겟 시리즈를 데이터 프레임에 합치기
data_target = pd.DataFrame(data = data_cancer.target, columns = ['target'])
breast_cancer = pd.concat([data_pd,data_target], axis = 1)
breast_cancer.head()
```



##### 2. Tidy data 확인



```python
#데이터 프레임 구조 확인

breast_cancer.info()
```

구조부터 확인하기



```python
#기술통계보기 中 통계수치 확인

breast_cancer.describe().T #칼럼이 많을 경우에는 전치를 시켜주면 보기 편함
```



데이터의 기술통계 확인

기술통계 중에 통계 수치 확인하기



```py
breast_cancer.boxplot(figsize = (10,5))
```



boxplot 그려서 각 데이터의 분포를 확인하기 (이상치도 확인)

![머신러닝2](C:/study/workspace_python/MachineLearning/%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D2.png)



```python
import seaborn as sns
sns.pairplot(breast_cancer, hue = 'target')
plt.savefig('머신러닝3')
```



각 변수의 상관관계 정도를 시각화하여 확인하기.

걸리는 시간이 오래 걸리니 주의!



##### 3. 데이터 분리하기



> 본 데이터 셋을 훈련 데이터와 테스트 데이터로 나눈다.
>
> 훈련 데이터를 통해서 모델을 학습시키고, 학습된 모델을 테스트 데이터를 통해서 평가한다.
>
> 이때 훈련데이터에 들어있는 data와 target 비율은 테스트 데이터의 data와 target 비율과 동일해야만 한다.
>
> 또한 훈련데이터와 타겟 데이터는 중복된 데이터가 있으면 안된다.



```python
#train_test_split으로 데이터를 분리하기 (과적합 방지)

from sklearn.model_selection import train_test_split
train_test_split(breast_cancer, test_size = 0.3, random_state = 0)
len(train_test_split(breast_cancer))

```



데이터 프레임을 넣어서 데이터를 분리한다.

분리된 데이터의 길이를 살펴보면 두 개로 분리가 되어있다.



##### 3.1 test_size

test_size = 0.25 로 디폴트값



```python
X,y = train_test_split(breast_cancer)
print(len(X))
print(len(y))
```



> test_size = 0.25 가 기본으로 설정되어 있음.
>
> 이 말은 만일 record 가 100개인 데이터셋이 있을 때, record를 train 으로 75개, test로 25 개를 배정하라는 뜻.



데이터셋 행 배정

X, train data -> 75%

y, test data -> 25 % 



##### 3.2 shuffle = True

또한 



shuffle = True 가 default 따라서 순서가 제멋대로이다.

따라서 holdout 할 때 마다, 행의 순서는 달라져서 도출된다. (분리된 데이터 셋을 확인하면)



```python
#shuffle False 설정하면 순서를 뒤섞지 않는다.
x,y = train_test_split(breast_cancer, shuffle = False)
x
```



셔플을 하지 않으면 정순서대로 나누게 된다.



##### 3.3 Random_state



```python
x,y = train_test_split(breast_cancer, test_size = 0.3, random_state = 42)
```



실행시킬 때 계속 똑같은 결과가 나와야 하는 경우가 있다.

분리의 결과가 계속 똑같이 나온다.



##### 3.4 데이터셋을 두 개 넣기



```python
#훈련데이터와 타겟데이터가 따로 있을 때는 따로 넣을 수 있다.
#하지만 훈련용이랑, 타겟용이랑 따로 넣으면 결과가 4개로 나온다.

train_test_split(breast_cancer.iloc[:,:-1], breast_cancer.target)

```



return => x_train, x_test, y_train, y_teset

x_train 을 보면 데이터 프레임 (data)

x_test 를 보면 데이터 프레임 (data)

y_train을 보면 시리즈 (target)

y_test 를 보면 시리즈 (target)

