# 빅데이터 탐색



### 데이터 전처리



##### 1. 데이터 정제

1. 데이터 전처리
2. 데이터 정제



데이터 정제는 데이터 전처리와 데이터 정제 과정을 거친다.



데이터 전처리 과정은 데이터를 정제한 후 분석 변수를 처리하는 순서로 진행된다.



목차를 다시 구성해보면



데이터 전처리 안에 1. 데이터 정제 -> 2. 분석 변수 처리 라고 할 수 있다.



1. 데이터 정제
   - 결측값 채우기
     - 결측값 : N/A, 결측값을 데이터의 중심 경향값으로 대체
   - 이상치 제거
     - 이상값 : 일반적인 데이터 범주를 벗어난 데이터들을 의미
     - 상한보다 높으면 상한값으로, 하한보다 낮으면 하한값으로 대체



(1) 데이터 결측값 처리하기



##### 결측값의 유형

1. 무작위 결측 (결측값의 결과에 영향을 주지 않는 결측)
   - 다른 변수와의 연관성에 따라서 완전 무작위, 무작위 결측
2. 비무작위 결측 (결측값의 결과에 영향을 주는 결측)



무작위 결측 (결측값의 결과에 영향을 끼치지 않음)

- 완전 무작위 (다른 변수의 무관하게 발생한 결측값)
- 무작위 결측 (다른 변수와 연관이 있음, 그러나 결측값이 결과 분포에 영향 x)

비무작위 결측

결측값이 다른 변수와 관련이 있음, 그리고 결측 결과 값이 결과 분포에 영향을 줌



##### 데이터 결측값 처리 방법



결측값을 제거하나 대체하여 결측값을 처리



1. 단순 대치법 : 특정 대푯값으로 결측값을 대체하는 통계적 기법

   - 1. 완전 분석법

        - 불완전한 자료는 모두 무시, 완전한 자료만 사용

     2. 평균 대치법

        - 평균, 중위수, 최빈값 등의 대푯값으로 대체

     3. 단순 확률 대치법

        - 평균 대치법에서 대푯값으로 결측값을 대치할 때, 적절한 확률값을 부여한 후 대치. 
        - 표준오차의 과소 추정 문제를 보완하기 위한 방법
        - 1. 핫덱 대체 : 응답자의 값으로 무응답을 대체, 현재 진행중인 설문조사에서 비슷한 성향을 가진 다른 응답자의 대답으로 대치
          2. 콜드덱 대체 : 핫덱 대체와 방식은 비슷, 대체 데이터를 현재 설문조사에서 얻는 게 아니라 다른 설문조사 데이터로 대체
          3. 혼합 방법 : 여러 가지 대체 방법을 혼합하는 방식, 회귀모형을 통해서 예측한 데이터와 콜드덱을 통한 데이터를 비교하여 결측값 대체

        

2. 다중 대치법 : 여러 번의 단순 대치법을 통해 결측값이 대체된 여러 개의 데이터를 생성 후, 해당 다수의 데이터를 통계 분석

   - 단순 대치를 통해 여러 개의 데이터 생성, 그리고 다수의 데이터들 분석



##### 데이터 이상값 처리



(1)데이터 이상치 검출



기본적으로 전체 데이터의 추이나 특성을 관찰하거나, 표본을 추출하고 관찰하여 이상값을 검출

즉, 데이터의 중심경향성 통계량과 산포도와 같은 통계량을 이용해서 이상치를 구할 수 있음.



1. ESD : 평균으로부터 표준편차 * 3만큼 떨어진 데이터들을 이상치 값으로 측정
2. 기하평균을 활용한 방법 : 기하평균으로부터 표준편차 * 2.5 떨어지면 이상치
3. 사분위수를 활용한 방법 : (제 3사분위 - 제 1사분위) * 1.5배 이상 떨어진 값을 이상치



또는 데이터 시각화를 통해서 나타낼 수 있음



1. 히스토그램 : 구간별 빈도수를 나타내서 데이터 분포 파악 가능
2. 밀도 차트
3. 박스 플롯 : 사분위수를 나타내고 사분위수를 벗어난 데이터를 이상치로 결정



그 이외 : 군집 분석, 마할라노비스 거리 같은 걸로 가능



(2) 데이터 이상치 처리



1. 삭제
   - 이상값을 제외하고 분석하는 방법
2. 대체
   - 하한값과 상한값을 기준으로 이상치가 하한가보다 낮으면 하한값으로 결정, 상한값보다 높으면 상한값으로 결정 또는 평균이나 중위수로 이상값 대체
3. 변환
   - 자연로그를 취해서 값을 감소시켜 실제값을 변형하는 방법, 자연로그화 시키면 정규 분포의 형태로 변환할 수 있는 장점도 가지고 있다.





##### 2.분석 변수 처리

(데이터 전처리는 데이터 정제 후 분석 변수 처리)



(1) 변수 선택

종속변수와 독립변수 

변수 선택이란 종속변수에 영향있는 독립변수를 선정하는 과정이다. 변수가 많기만 하면 유의미한 모델을 만들기 힘들다. 따라서 필요한 변수만을 선정해야만 한다.



1. 독립변수 : 다른 변수에 영향을 받지 않고 종속 변수에 영향을 끼치는 변수
2. 종속변수 : 독립변수에 영향을 받아서 변화하는 변수, 반응 변수 또는 결과 변수





변수의 속성에 따라서 변수 유형 나뉨



1. 범주형
   - 명목형 : 순서와 크기에 상관없이 이름만으로 의미를 부여 가능
   - 순서형 : 이름에 의미를 부여할 수 있으면서 순서에도 의미를 부여할 수 있는 변수
2. 수치형
   - 이산형 : 변수가 취할 수 있는 값을 하나하나 셀 수 있는 변수
   - 연속형 : 변수가 구간 안에서 모든 값을 가질 수 있는 경우, 소수점을 나타내는 변수



(2) 변수 선택 방법



1. 필터 기법

   - 데이터의 통계적 측정 방법을 사용하여 변수들의 상관관계 탐색
   - 특정 모델링 기법에 의존하지 않음

2. 래퍼 기법

   - 하위 집합을 반복하여 선택
   - 변수의 일부분만을 모델링하고 결과를 확인한다. 이 작업을 반복하여 최적의 변수들을 선택한다.
   - 1. 전진 선택법 : 모든 독립변수 중에서 종속변수에 영향을 크게 줄것 같은 변수부터 하나씩 추가하여 모형을 선택(좋은 독립변수부터 선정), 비어있는 상태에서 시작해서 변수를 추가할 때마다 AIC를 측정하고 더이상 나아지지 않으면 변수 선택 중지 (백지 -> 좋은거부터 하나씩 추가)
     2. 후진 제거법 : 모든 독립변수가 포함된 상태에서 종속 변수에 영향력이 별로 없는 것부터 제거, 모형 적합도 AIC 가 향상되지 않으면 변수 선택 중지
     3. 단계적 방법  :  전진 선택법과 후진 선택법을 같이 사용하는 방법, 전진 선택법으로 좋은 변수들을 추가하고, 추가된 변수들에서 후진 선택법을 이용해서 유의미하지 않은 변수들을 제거 

3. 임베디드 기법

   - 모델 자체에 변수 선택이 포함된 기법
   - 모델 학습 및 생성 과정에서 최적이 변수를 선택

   

   

   

   (3) 차원축소

   

   차원은 변수의 수로 표현, 변수의 수가 많을수록 차원이 커지고 그에 따라 모델의 정확도가 떨어질 수 있음.

   또한 종속 <-> 독립이 아니라 독립 변수들간의 상관관계가 높으면 모델의 성능이 떨어진다. 이때 차원축소를 활용.

   

   차원축소는 여러 개의 변수로 이루어진 데이터들의 데이터 정보를 최대한 유지하면서 변수를 줄이는 것

   하나의 완결된 분석기법이라기 보다는 보조식품임

   

   ##### 차원축소 방법

   

   가장 대표적 분석 기법은 주성분 분석

   

   1. 주성분 분석(PCA) : 여러 차원의 변수를 대표하는 주성분을 생성, 여러 변수의 분산이 가장 높은 축을 첫 번째 주성분으로 추출, 다음 주성분은 첫 째 주성분과 직교하는 성질
   2. 선형 판별 분석 :  데이터를 최적으로 분류하여 차원을 축소하는 방법, 주성분 분석은 데이터를 최적으로 표현하는 관저에서 차원을 축소
   3. 특이값 분해 : 주성분 분석과 달리 M X N 의 행과 열의 크기가 다른 행렬을 이용해서 차원을 축소한다.
   4. 요인 분석 : 데이터 안에 잠재 요인이 있을 때, 모델을 만들어서 잠재 요인을 도출하고 데이터 구조를 해석하는 기법
   5. 독립성분 분석 : 독립 성분 분석은 다변량의 신호를 통계적으로 독립적인 하부성분으로 분리하여 차원을 축소
   6. 다차원 척도법 : 개체들 사이의 유사성과 비유사성을 찾아내어 자료를 함축적으로 표현하는 분석 기법

   

   (4) 파생변수 생성

   

   기존 변수들간의 관계를 이용해서 새로운 변수를 생성 가능하다.

   다만, 주관이 포함될 수 있으므로 기준이 필요

   

   하나의 변수를 분해하거나, 여러 변수를 수식으로 엮거나 하여 파생변수 생성.

   

   (5) 변수 변환

   

   변수를 제거하거나 생성하는 것 뿐만 아니라 기존 변수를 분석 목적에 맞게 변환하는 과정도 필요하다.

   

   1. 로그/지수 변환 : 변수들의 분포가 한쪽으로 치우친 것을 정규분포화 시킴

   2. 비닝 : 연속형 데이터를 범주형 데이터로 변환하기 위해서 사용

   3. 더미 변수화 : 범주형 데이터를 연속형 데이터로 바꾸기 위해서 사용, 변수별 값을 값이 있으면 1, 없으면 0으로 표시하여 칼럼으로 변경

   4. 스케일링 : 데이터를 특정 구간으로 바꾸는 척도법

      

      

      (6) 불균형 데이터 처리

      

      암검사 같은 불균형 데이터를 그대로 사용하면 문제가 발생, 

      

      ##### 불균형 데이터 처리 방법

      

      1. 과소표집

         다수 클래스의 데이터를 무작위로 일부만 선택하여 데이터의 비율을 맞추는 방법

         데이터 소실이 너무 크다

      2. 과대표집

         소수 클래스의 데이터를 무작위로 복제하여 데이터의 비율을 맞추는 방법, 단 과적합 문제 발생 가능.

      3. SMOTE : 알고리즘에 따라서 소수 클래스의 데이터를 생성, 소수 데이터를 찾고 해당 데이터와 가까운 K개의 데이터를 찾은 후 주변 값을 기준으로 새로운 데이터 생성

         

      

      1, 

      3,

       3, (X)

      3,

      2,

      3, (X)

      4,

      4,(X)

      3,

      4,

      3,

      1,

      2,

      3,

      1,

      4,,

      

      2,

      3,

      4

      

      3,

   

   

   

   

   

   