# 확률과 통계(6)



> 지난 시간
>
> 여러 확률 분포에 대해서 살펴봤다.
>
> 1. 이산형 확률분포 (각 분포는 서로 관련이 있다.)
>    - 베르누이 분포
>      -  베르누이 실험 => 결과가 단 두 개인 경우 성공과 실패를 구분하고, 그랬을 경우 결과가 단 두 개가 나오는 실험을 베르누이 실험이라고 한다.
>      - 가장 대표적인 실험은 동전 던지기.
>      - 일반적으로 성공, 실패로 구분하고 그때의 성공 확률을 p, 실패 확률은 1-p 라고 한다.
>      - 베르누이 분포는 이러한 베르누이 실험을 1회 실행했을 때의 나오는 경우를 보고 확률 함수라던지 베르누이 분포를 따루는 확률변수의 평균, 분산 등을 살펴봤다.
>    - 이항분포
>      - 베르누이 실험을 n번 실행
>      - n번의 실행에서 성공의 횟수는 몇 번인지 따지는 게 이항분포다.
>      - 이항 분포를 따루는 확률 변수 x는 n번의 실행에서 성공 횟수가 몇 번인지 따지는게 이항분포
>    - 기하분포
>      - 베르누이 실험을 실행을 하는데, 확률변수 x의 정의가 다르다.
>      - 베르누이 실험을 진행할 때, 첫 번째 성공이 나올 때까지의 시행 횟수를 x로 설정한다.
>      - 즉, 첫 번째 성공이 나오는 경우가 몇 번째 실험에서 나오느냐 하는 문제들
>      - ex)_ 첫 번째 양성 반응이 나오는 게 x로 했다면 몇 번째 환자에서 양성 반응이 처음으로 나왔는지 확률을 구하는 문제
>      - 이때에도 성공확률 p가 중요한 역할을 한다.
>      - 기하분포의 평균은 1/p 이다. => 따라서 성공확률을 알고 있으면 평균적으로 첫 번째 성공이 나오기 위해서 시행할 횟수를 알 수 있다.
>    - 초기하분포
>      - 전체가 두 개의 그룹으로 나눠질 때를 의미한다.
>      - 성공 그룹과 실패 그룹이라고 했을 때, 전체를 대문자 N으로 한다면
>      - 성공 그룹은 k개 실패 그룹은 전체 N - k 개가 된다.
>      - 그 상황에서 소문자 n 만큼 비복원 추출을 한다. 이 때의 확률 변수 x는 샘플링한 n개 중에 성공이 몇 개가 있느냐를 다룬다.
>    - 포아송분포
>      - 시간이 관여를 하고 있는 분포
>      - 시간 (0,t) 사이의 사건의 발생 수를 확률 변수로 설정한다.
>      - 앞의 것들은 시행을 몇 번할 때의 성공 수를 의미한다면, 포아송 분포는 시간 (0,t) 사이의 성공의 개수 혹은 사건의 개수라고도 한다.
>      - 따라서 모수가 람다이고 평균과 분산이 둘 다 람다 또는 람다t 같은 값이라는 특징이 있다.
> 2. 연속형 확률분포
>    - 균일 분포
>      - a와 b사이의 균일 분포일때는 밀도함수가 같은 값을 가진다. 1/b-a
>    - 지수 분포
>      - 어떤 사건이 처음으로 발생할 때까지 걸리는 시간
>      - 어떤 시스템이 첫 번째 고장이 날 때까지의 시간
>      - 스마트폰을 처음 구입했을 때, 처음 고장이 날때까지의 시간
>      - 그 확률변수 x가 따르는 분포를 지수 분포라고 한다.
>      - 그리고 지수분포는 기억을 하지 못하는 memoryless property 를 갖고 있는 특징이 있다.
>      - 가끔 지수분포의 무기억성이 응용이 된다.
>    - 정규 분포
>      - 평균 뮤를 중심으로 분포가 좌우 대칭이다.
>      - 평균 뮤와 분산 시그마제곱 또는 표준편차 시그마 값에 의해서 분포의 모양의 결정이 된다.
>      - 즉, 평균과 분산에 의해서 분포의 모양이 달라진다.
>      - 따라서 정규 분포를 말할 때는, 어떤 평균과 어떤 분산을 따르는 정규분포를 따른다고 이야기를 해야한다.
>      - 정규 분포 중에서 가장 특징적인 분포가 있다면 표준 정규분포
>    - 표준 정규 분포
>      - 평균이 0이고 분산이 1인 또는 표준편차가 1인 정규 분포
>      - 표준 정규분포를 이야기 할 때는 굳이 평균과 분산을 이야기할 필요가 없다
>      - 일반 정규 분포 x에 대한 어떤 구간에 대한 확률을 구할 때는 표준 정규분포로 전환시킨 다음에 값을 찾는다. Z = (X - u) / 시그마
>      - 거의 대부분 표준 정규 분포를 따르는 확률 변수는 Z를 이용한다.
>      - 표준 정규 분포를 따르는 Z에 대해서 어떤 값보다 작은 확률 또는 어떤 값보다 크고 어떤 값보다 작은 확률은 표를 이용해서 얻을수도 있고 R을 이용해서도 얻을 수 있다.
>    - 
> 3. 중심극한정리
>    - 정규분포의 중요성을 나타내는 아주 중요한 정리
>    - n이 많아질수록 점점 표준정규분포로 수렴한다.



> 이번 시간
>
> 샘플링 분포(표본 분포?)
>
> 표본 자료의 함수 = 통계량 = 확률변수
>
> 그렇다면 통계량도 확률 분포를 따르고 이 분포를 샘플링 분포라고 한다.



> 학습 내용
>
> - 모집단과 표본의 확률분포
> - 통계량
> - 표본평균의 분포
> - 표본분산의 분포
> - t분포
> - F분포



<hr>

# 모집단과 모수





- 모집단
  - 연구대상이 되는 개체들의 전체 집합
- 모수
  - 모집단의 분포를 결정하는 상수(평균(뮤), 분산(시그마제곱), 표준편차(시그마))



##### 모집단의 분포는 평균이 뮤이고 분산이 시그마 제곱인 정규분포를 따른다고 가정을 한다.

 그 이유는 우리가 모집단의 분포를 모르기 때문이다. 따라서 평균이 뮤인지도 모르고 분산이 시그마 제곱인지도 모른다.



- 모평균
  - 모집단 전체의 평균
- 모분산
  - 모집단 전체의 분산



##### 모수를 구하는데 있어서의 문제점

모수를 알기 위해서는 모집단 전체에 대해서 알아야하지만, 모집단은 일반적으로 아주 많은 개체들로 구성되어져 있어서 비용이 너무 많이 들기 때문에 비경제적이다.

그리고 너무 많은 개체를 조사하다보면 정확성이 떨어진다.

따라서 규모가 작은 집단 ***표본을 대상***으로 모수에 대해서 연구를 해야만 한다. (그렇다면 표본은 모집단을 잘 대표해야만 한다.)



## 모집단과 확률분포



이제는 확률분포와 연계해서 모집단을 이야기 해야만 한다.

우리가 연구하고자 하는 모집단은 평균이 뮤이고 분산이 시그마제곱인 정규분포를 따른다고 가정한다. (대전체)



## 표본과 표본추출법



앞서 모집단의 모든 개체를 활용하여 모수를 구하는 것은 비용과 시간이 많이 들고 정확성이 줄어들기 때문에 불가능함을 살펴봤다.

표본 추출법을 통해서 모집단을 대표할 수 있도록 **표본**을 무작위로 추출한다.

그렇게 선택된 개체들을 표본이라고 부른다. => 모집단의 일부분이라고 부른다.

##### 중요한 지점은 우리는 모집단의 분포가 평균이 뮤이고 분산이 시그마제곱인 정규 분포를 따른다고 가정했기 때문에 모집단으로부터 추출한 표본 또한 평균이 뮤이고 분산이 시그마 제곱인 정규 분포를 따른다고 가정한다.

##### => 표본 개체들은 모집단의 분포와 동일한 분포를 따르고 있다.

> 그 이유 :
>
> x1은 첫 번째 선택된 개체이지만, x1이 어떻게 선택되느냐에 따라서 모든 개체들이 다 선택될 수 있는 가능성이 있는 것, 따라서 x1은 모집단과 같은 분포를 가진다. x2도 마찬가지고 xn 도 마찬가지다.
>
> 이 때의 샘플은 독립적으로 뽑아왔기 때문에 표본 x1, x2 x3 는 서로 독리적이고 모집단과 똑같은 분포, 평균이 뮤이고 분산이 시그마 제곱인 정규 분포를 따른다.
>
> => 모집단과 표본에 대한 중요한 가정.



## 통계적 추론



표본 자료를 이용하여 모수에 대한 정보를 얻는 방법이다.

더 구체적으로 이야기하면 **표본으로부터 통계량을 구하고 이 통계량을 이용해서 모집단의 모수를 추론하는 과정을 통계적 추론이라고 부른다.**

> 모집단으로부터 표본을 추출해서, 표본의 분포를 보면 정규 분포 모양을 가지고, 이 표본으로부터 통계량을 구한다. 그 다음 표본 평균 xbar 를 이용해서 모평균을 이용한다. 또 표본 분산 s^2을 이용해서 모분산 시그마 제곱을 구하고 싶은 것, 그리고 표준편차 s를 이용해서 모집단의 모수 시그마를 구하는 것.



## 통계량(statistic)



통계량은 표본만의 함수다. (모집단으로부터 추출한 표본으로부터 구한 어떤 값)

통계량은 확률변수이며 대문자를 사용한다.

특정 표본의 자료를 이용하여 계산한 결과는 소문자를 활용한다.

> 표본데이터 : 1,2,3,4,5
>
> 표본의 평균 : X_bar
>
> 구체적으로 계산한 표본의 평균 : x_bar = 3
>
> 이 문자 표시로 변수냐 계산한 값이냐를 구분하는 것.



### 표본 평균

=> 모집단에서 구하듯이 구하면 된다. (다 더하고 개수로 나누기)

### 표본 분산

=> 편차?오차? 를 제곱한 값을 모두 더한 걸 n-1 로 나눈 것, 모집단과 동일



![스크린샷 2022-04-10 오후 4.50.52](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 4.50.52.png)



통계량이란 표본만의 함수를 이용하는데 뮤같은 경우는 모집단의 평균이므로 통계량이라고 할 수 없다.



## 표본평균의 분포



모든 확률 변수는 고유한 확률 분포를 따른다.

어떤 새로운 확률 변수가 정의가 되면 그 확률 변수의 분포가 무엇인지 파악해야만 한다.



표본평균 X_bar 의 분포는 무엇인가?(표본평균을 하나의 확률 변수로 설정)

##### 표본평균은 평균이 뮤이고 분산이 시그마 제곱 / n 인 정규분포를 따른다.

##### 따라서 표준 정규분포화 하면 Z의 식은 X_bar - 𝛍 / 𝛔 / √n



> 굉장히 중요!!!!

***표본평균의 평균(기대값)*** =  𝛍(모집단의 평균) => 모집단의 평균과 표본평균의 평균은 동일하다.

***표본평균의 분산*** = 시그마^2 / n => 모집단 분산의 1/n



## 표본분산의 분포



표본분산의 분포를 이해하기 위해서 카이제곱분포를 이해해야만 한다.

표본분산을 구하는 공식을 살펴보면 분자에 제곱이 들어가기 때문에 선형이 아니기 때문에 새로운 확률분포가 소개가 되어야만 하는데, 이때 사용되는 분포가 카이제곱분포이다.



### 카이제곱 분포의 정의



1. 평균이 0이고 표준편차가 1인 정규분포를 따르는 표준정규분포 Z가 있을 때,  Z제곱이 따르는 분포를 자유도가 1인 카이제곱 분포를 따른다고 정의를 내린다.

2. Zi ~ Zn 개가 있을 때, 각각의 Zi 들이 서로 독립이고 서로 동일한 표준정규분포를 따른다고 하면 Y = Z1^2 + ... Zn^2 이라고 하는데, Y가 따르는 분포를 자유도가 n인 카이제곱분포를 따른다고 한다.



### 카이제곱 분포의 특징



각각 n1, n2 자유도를 따르는 서로 독립인 카이제곱분포 Y1, Y2가 있을 때, 이 두 분포를 더하면 Y1+Y2는 자유도 n1+n2 를 가지는 카이제곱분포를 따른다.



> 굉장히 중요

##### 자유도 n을 따르는 카이제곱분포 Y 가 있을 때, 이 카이제곱분포의 평균은 E(Y) = n, Var(Y) = 2n 이 된다.



그렇다면 카이제곱분포는 자유도에 따라서 분포의 모양이 달라진다.

따라서 자유도를 꼭 말해줘야 한다.



> 카이제곱분포의 자유도는 이 변수를 정의할 때 표준정규분포가 몇 개가 사용되었느냐가 자유도의 값이다.
>
> 카이제곱분포의 정의 2를 보면 이해가 쉽다.



### 표본분산의 분포 유도



![스크린샷 2022-04-10 오후 5.25.44](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.25.44.png)





어떤 공식을 쭉쭉 따라가서 위의 식이 도출된다. (표본분산 S^2에 관한 분포)

주목할점은 n-1개의 자유도를 따른다는 것.



<hr>

## 정규분포를 이용한 문제들





![스크린샷 2022-04-10 오후 5.27.06](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.27.06.png)



![스크린샷 2022-04-10 오후 5.30.45](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.30.45.png)



![스크린샷 2022-04-10 오후 5.34.30](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.34.30.png)



![스크린샷 2022-04-10 오후 5.37.51](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.37.51.png)



<hr>



![스크린샷 2022-04-10 오후 5.38.09](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.38.09.png)



R을 이용하기



```R
#자유도가 15인 카이제곱분포를 따르는 확률변수 X 가 12.5 보다 작은 확률을 구하기 
pchisq(12.5, 15)
```



<hr>

![스크린샷 2022-04-10 오후 5.41.42](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.41.42.png)



 ![스크린샷 2022-04-10 오후 5.44.15](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.44.15.png)



```R
#자유도가 39인 카이제곱분포를 따르는 확률변수 v가 27.5보다 낮을 확률을 구하기
pchisq(27.5, 39)
```



<hr>



![스크린샷 2022-04-10 오후 5.45.13](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.45.13.png)



![스크린샷 2022-04-10 오후 5.48.05](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.48.05.png)



<hr>

![스크린샷 2022-04-10 오후 5.59.12](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 5.59.12.png)



지금까지의 내용은 표본을 통해서 모집단의 모수를 추론할 때 확률변수의 분포를 활용함을 살펴봤다.

표본의평균 즉 표본평균과 표본의 분산 즉, 표본분산은 위의 그림과 같은 분포들을 따름을 살펴봤다.



## t분포의 정의



다음으로는 t분포가 등장하게 된다.



###### t분포의 정의

- Z는 표준정규분포를 따르고 V가 자유도가 k인 카이제곱분포를 따른다고 할 때, 이 두 분포가 서로 독립이면
- 새로운 변수 ***T = Z/√V/k*** 는 자유도가 k인 t분포를 따른다고 한다.
- 

![스크린샷 2022-04-10 오후 6.03.24](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.03.24.png)

 

복잡하게 생긴 이 모양을 아래위 정리를 해보면, 다음과 같은 그림의 식이된다.



 ![스크린샷 2022-04-10 오후 6.04.59](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.04.59.png)



### t분포의 특징



- 평균이 0
- 표준정규분포보다 양쪽 꼬리가 길다. 가운데 봉우리가 조금 더 낮다.
- 좌우 대칭이다.
- t분포의 밀도함수는 평균 0 에 대하여 좌우대칭이다.
- 자유도 n이 무한대로 가면 자유도가 n인 t분포는 표준정규분포로 수렴한다.



> 근데 t분포의 분포식을 보면 뮤가 존재하기 때문에 통계량이라고 할 수 없다. 따라서 뮤를 대체하는 값을 넣어야지만 통계량으로 활용할 수 있다.



<hr>



![스크린샷 2022-04-10 오후 6.10.09](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.10.09.png)



```R
#자유도가 25인 t분포에서 1.96보다 작을 확률
pt(1.96,25)
#표준정규분포에서 1.96보다 작을 확률
pnorm(1.96)

#표준정규분포와 t분포는 많이 비슷하다.
pt(1.96, 1000) #표준정규분포에서의 1.96보다 작을 확률의 값과 근사해진다.

```



![스크린샷 2022-04-10 오후 6.13.31](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.13.31.png)



```R
1-pt(-1.2,22) #0.8785
```



## F분포의 정의



f분포의 정의

자유도가 두 개임.



![스크린샷 2022-04-10 오후 6.17.56](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.17.56.png)



![스크린샷 2022-04-10 오후 6.20.11](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.20.11.png)





카이제곱변수를 각각의 자유도로 나누어준다.



![스크린샷 2022-04-10 오후 6.20.56](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.20.56.png)

따라서

![스크린샷 2022-04-10 오후 6.21.16](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.21.16.png)

이 된다.



>  이 분포의 식에도 분산 시그마제곱이 들어가있기 때문에 통계량이라고 할 수 없다.
>
> 따라서 이 수를 대체할만한 대체값을 찾아서 넣어줘야 한다.



### f분포의 특징



1. 자유도 순서는 중요하다

   - f(10,5) != f(5,10)

2. f분포에 대한 확률분포표를 보면 한쪽만 죽어있다.

   

3. ![스크린샷 2022-04-10 오후 6.24.56](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.24.56.png) 

4. t분포와 f분포와의의 관계성

   - 자유도가 k인 t분포를 제곱하면 자유도가 (1,k)인 F분포가 된다.





<hr>



![스크린샷 2022-04-10 오후 6.26.51](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.26.51.png)



```R
pf(2.35,10,20)

#확률이 0.99인 지점을 찾을 때 사용.
#값이 5.64가 도출되는데, 5.64보다 작은 확률이 0.99가 된다는 뜻.
qf(0.99,5,10)

#q는 역함수 역할을 하는데, 어떤 확률을 얻고자 하는데, 그 확률을 가지는 값을 찾을 때 활용
qnorm(0.975)
```



<hr>





![스크린샷 2022-04-10 오후 6.29.47](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.29.47.png)

##### 

x가 t분포를 따르고 그때 자유도가 k라면 x^2 은 어떤 분포를 따를까?



![스크린샷 2022-04-10 오후 6.33.37](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-10 오후 6.33.37.png)



