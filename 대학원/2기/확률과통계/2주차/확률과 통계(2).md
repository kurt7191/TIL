# 확률과 통계(2)



이번 주는 확률에 대해서 살펴볼 예정



- 확률 실험
- 확률의 정의
- 확률의 공리
- 조건부확률
- 베이즈 정리



<hr>



## 확률 실험



확률(probability)



##### 확률 실험(random experiment)

실험의 결과를 예측할 수 없고, 동일한 조건으로 실험을 반복하더라도 그 실험의 결과가 임의의 형태로 나타나는 특징을 갖는 실험



ex) 동전 던지기, 주사위 굴리기, 키, 무게 측정



##### 표본 공간



확률 실험을 할 때 모든 발생 가능한 **결과** 들의 집합

주로 대문자 S 로 나타냄



> 동전 던지기 확률 실험
>
> 표본공간 S = {H,T} , H: 앞면, T: 뒷면
>
> 
>
> 주사위 굴리기 확률 실험
>
> 표본공간 S = {1,2,3,4,5,6}
>
> d
>
> 중학생 키 측정 확률 실험(연속적 데이터에서)
>
> 표본공간 S = {x : 110 <=x <=190(cm)}



##### 사상(event)



확률실험에서 **관심이 있는 실험 결과** 들만의 집합

- 사상들은 표본공간의 부분 집합
- 주로 대문자 A,B,C 등으로 표기



Ex) 주사위 중에서 짝수인 것만 알고 싶다. (결과가 짝수인 사상) or 결과가 홀수인 사상

or 결과가 4 이상인 사상

=> ***사상은 표본 공간의 일부임***

> 표본공간 S = {1,2,3,4,5,6}
>
> A = {2,4,6}
>
> B = {1,3,5}
>
> C = {4,5,6}



##### 특별사상

Ex) 사상 A와 B의 합집합

- AUB 

U = union

사상 A 또는 사상 B에 속하는 원소들의 집합

**a에도 있고 b에도 있는 원소는 한 번만** 적는다.



> 주사위 굴리기 확률 실험 중
>
> A = {2,4,6}
>
> B = {1,3,5}
>
> AUB = {1,2,3,4,5,6}



- A n B

원소가 a에도 있고 b에도 있는 원소들만의 집합을 의미한다.

> 주사위 굴리기 확률 실험 중
>
> A = {2,4,6}
>
> B = {1,3,5}
>
> A n B = {𝞥} => 짝수와 홀수의 교집합은 존재하지 않는다.
>
> *공집합은 원소가 하나도 없는 집합(empty set), 0과는 구분이 된다.



- 사상 C의 여집합(C prime)

표본 공간에서 사상 C의 원소만 제외한 원소들의 집합이다.

> C = {4,5,6}
>
> C의 여집합은 {1,2,3}



여러 사상이 있을 때, 사상들의 관계에 대해서 살펴보자.



##### 상호배반(mutually exclusive)



A와 B의 교집합은 공집합이 되기 때문에 a와 b는 서로 상호배반 관계라고 한다.

a와 b가 상호배반관계에 있으려면 무엇을 확인해야 하는가?

a와 b의 교집합을 확인해야 한다. 만일 이 두 집합의 교집합이 공집합이 되면 상호배반 관계라고 한다.



##### 상호포괄(collectively exhaustive) 관계



a와 b의 합집합은 표본공간이 되었다.

이러한 경우를 a와 b는 상호포괄 관계에 있다고 말한다.

두 집합이 상호포괄관계인지 확인하기 위해서는 a와 b의 합집합을 확인하고 그 합집합이 표본공간 S가 되면 두 집합은 상호포괄관계이다.



> 정리
>
> 두 집합의 교집합이 공집합이면 상호배반 관계
>
> 두 집합의 합집합이 표본공간이면 상호포괄 관계



##### 분할(partition)



여러 개의 사상이 상호배반관계와 동시에 상호포괄관계를 갖는 경우

이런 경우에 그 사상을 **표본공간을 분할한다** 고 한다.



a와 b는 상호 배반관계인 동시에 상호포괄관계를 가지고 있었다.

**사상 a와 b는 표본공간 s를 분할한다.** (두 집합의 사상이 동시에 상호배반관계와 상호포괄관계를 가지고 있을 때)



<hr>

##### 예제 풀이



표본공간 S = {0,1,2,3,4,5,6,7,8,9}

A = {0,2,4,6,8}

B = {1,3,5,7,9}

C = {1,2,3,4,5}

D = {6,7,8,9}



(1) A U B : {0,1,2,3,4,5,6,7,8,9}

(2) B n C : {1,3,5}

(3) A n B : 𝞥 or {}

(4) C ' : {0,6,7,8,9}



<hr>

## 확률의 정의



1. 고전적 확률의 정의

   사상 A가 정의되어 있을 때(동전 던지ㅌ)

   P(A) = n(A) / n(S) => n(A) 는 a집합의 원소의 개수, n(S) 는 S의 원소의 개수

   - 사상 A가 발생한다?
     - 확률 실험의 결과가 a의 원소면 사상 a가 발생했다고 한다.
     - Ex) 주사위를 굴렀을 때, 사상 a = {2,4,6} 일 경우, 주사위를 굴렀을 때 2가 나오면 사상 a가 발생했다고 한다.
   - Ex) 동전을 던졌을 때 앞면이 나올 확률 1/2 는 앞면이 나오는 사상의 수 / 표본 공간의 원소의 수를 의미한다.

   

2. 경험적 확률의 정의

   n번의 확률 실험에서 사상 A가 발생하는 확률(타율)

   n(A)/실험 횟수 => n(A) 는 사상 A의 발생 횟수

   - 실행 횟수를 무한대로 했을 때의 의미를 갖고 있다.
   - 실제로 일어나는 결과들을 무한번 반복했을 때의 비율로 정의한다.





우리가 통계를 이야기 할 때는 고전적 확률과 경험적 확률을 사용하는데, 주로 고전적 확률을 많이 사용한다.



##### 예제 풀기



2개의 주사위를 동시에 굴렀을 때 나타나는 숫자의 합이 9가될 확률을 얼마인가?



표본공간 : S = {(1,1),(1,2),(1,3).....(6,6)}, n(S) = 36

구하고자 하는 확률 : 두 개의 주사위의 숫자의 합 9가 될 확률 : (3,6),(4,5),(5,4),(6,3)



p(합이 9) = n(A) / n(S) = 4 / 36 = 1/9



1. > 1. 표본공간의 원소는 몇 개가 있는지
   > 2. 우리가 관심있는 사상에는 원소가 몇 개가 있는가? (합이 9인 사상)



##### 곱셈 법칙

1단계 2단계 3단계로 가서 어떤 일이 끝나는 과정을 가정하자

>  1단계에서 선택할 수 있는 방법은 n1개
>
> 2단계에서 선택할 수 있는 방법은 n2개
>
> 3단계에서 선택할 수 있는 방법은 n3개



단계1에서 단계3을 거쳐 가는 동안에 몇 가지의 서로 다른 방법의 결과를 만들어 낼 수 있는가?

**출현 가능한 결과의 수는 n1 x n2 x n3**



##### 예제 풀기



2019년 9월 이전 -> 두자릿수 + 한글 + 숫자 4자리

2019년 9월 이후 -> 세자릿수 + 한글 + 숫자 4자리

렌터카, 군용, 승용자동차 번호판 숫자 3자리 확정

영업용, 승합차 화물차 특수차 해당 사항 없음

군용은 앞 번호는 부대 번호를 사용

군용 및 외교 차량을 제외한 모든 차량의 발생 가능한 자동차 번호판은 2억개가 넘는다.





##### 순열(permutation)



n개의 원소 중에서 우리가 r개의 원소를 선택해서 순서를 고려하여 나열하는 경우에 **출현 가능한 결과의 수를 찾아낼 때** 사용하는 방법



keyword : 순서를 고려한다.



nPr = n! / (n-r)!



ex) 알파벳 a,b,c,d, 이 중에서 두 개를 선택해서 비밀번호를 만든다.

a와 b를 선택했을 때 ab,ba => 순서가 고려되기 때문에

선택된 알파벳은 같지만 순서가 다르기 때문에 서로 다른 비밀번호가 되는 것.



4! / (4 - 2)! = 12





##### 조합(combination)



n개의 원소 중에서 r개의 원소를 선택해서 순서에 관계없이 나열하는 경우에 출현 가능한 결과의 수를 찾아낼 때 사용하는 방법

keyword : 순서에 관계 없다.



nCr = n! / (n-r)!r!

ex) 8C2 = > 8! / 6! * 2 ! => 8 * 7 / 2 ! => 56 / 2 * 1 = 28



순열로 볼 때는 ab, ba 다르지만 조합 입장에서는 ab, ba 같게 본다.

그래서 순열 식에다가 2!로 나눠버린 것.



> 기억해야 할 특별한 조합
>
> nCn = 1 (순서를 고려하지 않은 조합)
>
> nC0 = 1 (n개 중에서 하나도 뽑지 않은 경우는 없다. 없다를 1로 표현)
>
> nCr = nCn-r 과 같다. (순서를 고려하지 않기 때문)
>
> nCr = 0 if r > n (사과 5개 중에 6개를 골라서 나열하는 법은 몇 개?)





##### 예제 풀기



한국 프로 야구는 7개의 매치 중에서 4매치를 먼저 우승하는 팀이 승리하는 방식

a팀이 7번째 경기에서 프로 야구 우승할 경우의 수는 몇 가지 인가?



_ _ _ _ _ _ A

6C3 = 6! / (6-3)! * 3 ! = 6 * 5 * 4 / 3 ! = 5 * 4 = 20가지



a팀 b팀 정하지 않고 7번째 경기에서 한국 프로 야구 시리즈가 끝나는 경우의 수는 a : 20, b : 20 총 40가지다.



로또 1등 당첨도 combination 을 이용해서 풀기 가능하다.





##### 합집합과 교집합의 확률



A U B 의 확률

P(A) + P(B) - P(AnB) => 서로 겹치는 부분이 있기 때문에 교집합을 빼준다.



하지만 만일 a와 b가 서로 상호배반이라면

p(A U B) = P(A) + P(B)



##### 예제풀이



P(A) = 0.37

P(B) = 0.44

P(AnB) = 0.21, (a,b 상호배반이 아니다)

P(AUB) = 0.37 + 0.44 - 0.21 = 0.6

 

##### 확률의 공리



1. 0 < P(A) < 1
   - 가장 작은 사상은 공집합, 가장 큰 사상은 표본공간
   - 사상 A는 공집합과 표본공간의 그 중간에 있기 때문
2. P(S) = 1
   - 표본공간이 발생할 확률은 1이라는 의미 = 표본공간은 항상 발생
   - 확률 실험은 반드시 결과가 발생하고 그 발생결과는 표본공간에 속한다. 
   - 따라서 표본공간은 항상 발생하기 떄문에 1이다.
   - 공집합이 발생할 확률은 표본공간의 여집합이기 때문에 0
3. A1, A2 등이 서로 상호배반이면 서로 합집합이면 계속 확률을 더해주면 된다.
   - 사상들이 상호배반이면 교집합은
   - 합집합에 대한 확률은 각 사상의 확률의 합



<hr>

## 조건부 확률(conditional probability)



사상 A 가 일어났다는 조건 하에 사상 Brk 발생할 확률

기호는 P(B|A) 를 사용



P(B|A) = P(A n B) / P(A)

IF P(A) > 0



> 사상 B의 확률
>
> p(B) = P(B|S) = n(B) / n(S)
>
> 관심의 대상이 표본공간 S에서 사상 B의 발생 확률
>
> 
>
> p(B|A)
>
> 위의 b의 확률에서 사상 A로 관심대상이 좁혀졌기 때문에 s대신에 p(A)를 사용 (s -> a로 축소)
>
> 그 조건 하에서 사상 b의 발생 확률이기 때문에 교집합 사용





##### 예제 풀어보기



40명 수강 과목 a 안경 쓴 학생의 비율 60%

3학년 학생의 비율이 40

안경을 쓴 3학년 학생의 비율 30

한 학생을 임의로 불렀을 떄 그 학생이 안경을 쓴 학생이다.

그렇다면 이 사람이 3학년 학생일 확률을 구하라



A : 3학년 학생 : 0.4

B : 안경을 쓴 학생 : 0.6

AB : 안경을 쓴 3학년 학생의 비율 : 0.3

우리가 구하려고 하는 확률 : P(A|B) 

=> P(AB) / P(B) => 0.3 /0.6 = 0.5 



##### 비복원추출



추출을하고 다시 집어넣지 않고 남아있는 개체수로 다시 추출하는 과정을 의미한다.



##### 사상 A,B 의 독립



주사위를 처음 돌렸을 떄와 주사위를 두 번째 돌렸을 떄는 연계적이지 않고 독립적이다.

이를 두 사상 a와 b는 서로 독립이라고 이야기 한다.

식은

P(A|B) = P(A)

P(B|A) = P(B)

두 사상이 전혀 영향을 끼치지 않았을 때 위의 두 식을 가진다. a와 b는 서로 독립이다.



사상 a와 b가 독립이라면 조건부 확률 공식을 통해서보면



P(A|B) = P(AB) / P(B) = P(A)

P(AB) = P(A)P(B) 가 성립, 이게 성립하면 사상 a와 b는 서로 독립이다.



2개의 사상이 있을 때 독립적이지 않다면 조건부 확률을 계산해야 한다.

p(AnB) = P(A)P(B|A) = P(B)P(A|B)

#### 

##### 사상 A,B,C 가 서로 독립



P(ABC) = P(A)P(B|A)P(C|AB) 로 해야될 것을 P(A)P(B)P(C) 로 계산할 수 있다.

즉, 상호 독립이라고 하면 계산량을 많이 줄여준다.



> 서로 독립이기 위해서 가져야할 조건
>
> p(ab) = p(a)p(b)
>
> p(ac) = p(a)p(c)
>
> p(bc) = p(b)p(c)
>
> p(abc) = p(a)p(b)p(c)



##### 사상 A,B,C,D 의 독립



P(A)P(B|A)P(C|AB)P(D|ABC) 로 구해야 하지만 서로 독립이라면, P(ABCD) = P(A)P(B)P(C)P(D)

마찬가지로 서로 독립이라면 계산량이 줄어든다.





##### 베이즈 정리란?



만약 a1,a2...an 이 표본공간을 분할하면



p(ak|b) = p(b|ak) * p(ak) / p(b|a1)*p(a1) + ... +p(b|an) * p(an)





##### 예제 풀기



회사 a,b,c 로부터 30, 30, 40 동일 부품 공급받는다.



불량율

a,b : 0.01

c : 0.005



1개뽑아서 검사했더니 불량

이 부품을 a회사가 제조했을 확률은 얼마인가?



사전 정보부터 정리



p(A) = 30% ------0.01 = P(D|A)

P(B) = 30% -----0.01 = P(D|B)

P(C) = 40% -----0.005 = P(D|C)





우리가 구하고 싶은 식 : P(A|D)

사전 정보들을 활용해서 구할 수 있다.



P(A) = 0.3, 

P(D|A) = 0.01

P(B) = 0.3 

P(D|B) = 0.01

P(C) = 0.4 

P(D|C) = 0.005





What is p(A|D)?



= P(A n B) / P(D)

P(D) = P(D|A)P(A) + P(D|B)P(B) + P(D|C)P(C) = 0.008

p(AD) = P(D|A)P(A) = 0.01 * 0.3 = 0.003



고로 0.003 / 0.008 = 3/8 = 0.375



베이즈 정리는 사전정보들을 활용해서 우리가 알고 싶은 확률을 구할 수 있다.



<hr>



2주차 과제



자동차 엔진을 생산하는 업체는 협력업체 A, B, C로부터 동일한 디자인의 부품을 공급받아서 창고에 보관을 하고 있다가 사용한다.
창고에는 A, B, C 회사 제품이 각각 150개, 600개, 250개가 있다. 각 회사의 불량들은 0.04, 0.01, 0.03이다. 창고에서 한 개를 임의로 골라 검사를 했더니 불량품으로 판명되었다. 
베이즈 정리를 이용하여 이 부품을 A회사가 만들었을 확률을 구하라. 



사전정보 : 

P(A) = 150/1000

P(B) = 600/1000

P(C) = 250/1000

P(D|A) = 0.04

P(D|B) = 0.01

P(D|C) = 0.03



P(A|D) = P(AD)/P(D) = P(D|A)P(A) / P(D)



P(D) = P(D|A)P(A) + P(D|B)P(B) + P(D|C)P(C)

= 0.006 + 0.006 + 0.0075 = 0.0195



P(AB) = P(D|A)P(A) = 0.04 * 0.15 = 0.006



0.006 / 0.0195 = 0.3076...

약 30%



<hr>

## 응용하기 과제



1개의 주사위를 두 번 굴럈을 때 나타난 숫자의 합이 4일 사상을 A, 두 번 모두 나타난 숫자가 짝수일 사상을 B라고 할 때 사상 A U B 의 확률을 구하라;.



36가지 표본공간 s를 가진다.



A = {1,3},{2,2},{3,1}

B ={2,2},{2,4},{2,6},{4,2},{4,4},{4,6},{6,2},{6,4},{6,6}

A U B = {2,2} 











































































