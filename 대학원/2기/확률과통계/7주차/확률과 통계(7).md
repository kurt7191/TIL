# 확률과 통계(7)



> 지난 시간
>
> 모집단과 표본의 확률 분포에 대해서 살펴봤다.
>
> 모집단은 평균이 뮤이고 분산이 시그마 제곱인 정규분포를 따른다고 가정을 한다.
>
> 따라서, 그 모집단으로부터 추출된 표본 또한 동일한 평균이 뮤이고 분산이 시그마 제곱인 정규분포를 따른다.
>
> 특히나 표본을 우리가 x1,x2,...xn 이라고 했을 떄, x1 ~ xn 들은 서로 독립적이고 하나같이 동일한 모집단의 분포와 같다.
>
> x_i는 iid, 첫 번째 i는 서로 독립임을, 두 번째 i는 identical 동일한 분포를 의미한다. 
>
> 모집단은 뮤, 분산이 시그마 제곱인 정규 분포를
>
> 표본도 마찬가지로 똑같은 평균이 뮤, 분산이 시그마 제곱인 정규 분포르 따른다고 가정했다.
>
> ㅇ
>
> ㅇ
>
> 통계량 : 표본만의 함수를 의미한다.
>
> 그 통계량 중에서 가장 대표적인게 바로 "표본 평균" 인 x bar
>
> 표본평균의 분포는 무엇인지에 대해서 알아봤는데 평균이 뮤이고 분산이 엔ㅇ분의 시그마 제곱의 정규 분포를 따른다.
>
> 이 분포는 널리 사용되기 때문에 꼭 외워둬야 한다.
>
> 그리고 
>
> 표본 분산의 분포는 (n-1)s^2 / 시그마 제곱은 자유도가 n-1인 카이제곱 분포르 따른다를 잘 알아둬야 한다.
>
> 여기까지 표본 평균의 분포와 표본 분산의 분포를 살펴봤다.
>
> ㅇ
>
> ㅇ
>
> t분포
>
> t분포는 특히 평균 0을 중심으로 좌우 대칭이며 표준 정규분포와 모양이 비슷한듯 하지만 표준정규분포보다는 훨씬 가운데 봉우리가 낮고 꼬리가 긴 넓게 퍼져있는 분포라고 할 수 있다.
>
> 그러나 t분포의 성질은 자유도 n이 무한대로 가면 t분포는 표준 정규분포로 수렴한다.
>
> d
>
> d
>
> f분포
>
> 자유도가 두 개인 분포
>
> 우리가 유의해야 할 점은 첫 번째 자유도와 두 번째 자유도의 순서를 바꿔서는 안된다는 것
>
> f분포는 두 개의 자유도에 의해서 좌우된다.
>
> t분포와 f분포간의 관계에서 t분포 확률 변수의 제곱은 f분포를 따르게 된다
>
> 그때 f분포의 자유도는 1 t분포의 자유도 n-1이든 k든 등등
>
> 따라서, 정규분포 표준 정규분포 카이제곱 분포 t분포  f분포는 서로 다 연결이 되어 있다.
>
> 서로 분포를 정의할 때, 상호 연결이 되어 있기 떄문에 다 함께 알아두길 바란다.
>
> 여기까지 지난 시간에 살펴본 내용
>
> ㅇ
>
> ㅇ
>
> 이번 시간에는 추정을 알아볼 예정
>
> 추정은 표본 자료를 이용해서 모수를 알아내는 방법
>
> 추론 통계학 하면 표본 자료를 이용하여 모집단의 특성 즉 모수를 알아내는 분야인데, 추론 통계학에는 크게 추정과 가설 검정으로 나뉜다.
>
> 이번 시간에는 추정에 대해서 알아볼 예졍이다.



추정이란 표본자료를 이용해서 모집단의 모수를 알아내는 방법이다.



1. 추정의 개념
2. 점추정 (추정에는 점추정과 구간추정이 있는데 이번 시간에는 점추정)
   - 최우도추정
   - 모멘트방법
   - 베이지안추정
3. 점추정량 판정기준





<hr>



## 추정이란



- 어떤 근사치를 찾아내는 방법

- > 모집단의 특성을 결정하는 상수 즉 모수는 알려져 있지 않다. 우리가 모집단의 분포는 평균이 뮤이고 분산이 시그마 제곱인 정규분포를 따른다고 이야기 했다. 그 때 모집단의 분포를 결정하는 상수는 뮤와 시그마 제곱이다. 그 뮤와 시그마 제곱을 모수(parameter) 라고 이야기 한다. 
  >
  > 근데 이 뮤와 시그마 제곱은 알려져 있지 않다. 이 뮤와 시그마 제곱을 알기 위해서는 모집단 전체를 조사해서 모집단의 평균가 분산을 알아내면 되지만 이는 힘들다. 그래서 표본 자료를 이용 한다.

- 표본 자료를 이용하여 위에서 설명한 모수를 추정하는 방법



- ##### 추정(estimation)

  - 점추정(point estimation)
    - 한 개의 값을 이용해서 모수 추정
    - 뮤의 값은 20이다.
    - 뮤의 값은 50이다.
    - 한 개의 수치로 예측을 하는 것.
  - 구간추정(interval estimation)
    - 구간의 값을 찾아서 이 구간이 모수를 포함하고 있지 않을까? 라는 이야기를 하려고 하는 것.
    - 이는 다음 시간에 상세하게 다룰 예정

- 추정량(estimator)

  - 통계량 중에서 **모수 추정에 사용된 통계량**을 추정량이라고 부른다.
  - 따지고 보면 추정을 위한 통계량을 줄여서 추정량이라고 부른다.
  - 통계량은 확률 변수인데 추정량도 확률 변수다.
  - 확률 변수는 분포를 가지고 있다.
  - 추정량을 알아내고 추정량의 확률 분포를 알아내는 것이 당연한 순서.

- 추정값(estimate)

  - 특정 표본자료를 이용해서 우리가 추정량의 값을 계산한 것. 이를 추정값이라고 이야기 한다.





## 모집단의 특성을 나타내는 모수 정리



- 이항분포의 성공 확률 p
  - 실행 횟수 n과 확률 p가 있어야만 이항 분포의 성공 확률을 정확하게 찾아낼 수 있다.
- 포아송분포의 평 람다
  - 평생 발생 건수 람다가 있어야 포아송 분포의 평균 값도 알지만 포아송 본포의 분산도 람다
- 정규분포
  - 뮤, 시그마 제곱

> 모집단 분포의 모수를 세타라고 한다. 세타는 어떨 때는 p가 어떨 때는 람다 어떨 때는 뮤, 시그마 제곱이 된다.
>
> 세타의 용어 정의라고 할 수 있음 (p, 람다, 뮤, 시그마 제곱)



- 모수를 알아내기 위해서 표본 자료의 함수인 통계량을 이용한다.
- 모수 측정을 위한 통계량 = 추정통계량 = 추정량 = 세타 햇을 사용한다. 
  - 이는 모수 세타와 구분하기 위함임
- 이항분포의 성공 확률 p의 추정량은 p 햇
- 포아송 분포의 평균 람다의 추정량은 람다 햇
- 정규분포는 뮤햇, 시그마제곱 햇





## 점추정



- 표본자료를 이용해서 모수에 대한 한 개의 값을 구한다.
- 점이 들어간다는 건, 한 개의 값을 가지는 점에 불구하기 때문이다.
- 최우도 추정
- 모멘트 방법
- 베이지안 추정



## 점추정 대상



1. 모평균
   - 모집단 전체의 평균

2. 모분산
   - 모집단 전체의 분산

3. 모평균차
   - 두 모집단 평균 간의 비교
   - 뮤1 - 뮤2

4. 모비율(p)

   - 이항분포의 성공 확률

5. 모비율차

   - 두 모집단 비율 간의 비교 (p1 - p2)

   

   

   

   

- 모평균 추정량
  - x bar
- 모분산 추정량
  - s^2
- 모평균차 추정량
  - X1 bar - x2 bar
- 대응비교 모평균 추정량
  - ![스크린샷 2022-04-17 오후 7.28.56](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.28.56-0191982.png)
- 모분산비 추정량
  - s1^2 / s2^2
- 모비율 추정량
  - p 햇
- 모비율차 추정량
  - P1 햇 - p2 햇



## 추정량과 관련된 확률분포



추정량은 확률 변수라고 할 수 있고

확률 변수는 고유한 확률 분포를 가진다.



그렇다면 추정량과 관련된 확률분포를 살펴보자.



- 표본 평균의 확률 분포
  - 평균이 뮤이고 분산이 시그마 제곱 / n 을 따른다.
- 표본분산의 확률 분포
  - (n-1)s^2 / 시그마제곱 ~ 자유도가 n-1 인 카이제곱 분포를 따른다.
- 모평균차 추정량의 확률분포
  - X1 bar - x2 bar ~
  - 두 표본이 서로 독립이다. 따라서 x1 bar x2 bar 도 서로 독립이다.
  - 따라서 둘 다 정규분포를 따르기 때문에 이에 선형함수인 x1 bar - x2 bar도 정규 분포를 따른다.
  - N(뮤1 - 뮤2, 시그마1 제곱 / n1 + 시그마2제곱 / n2) => 정규분포
- 대응비교 모평균 추정량의 확률분포
  - ![스크린샷 2022-04-17 오후 7.34.31](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.34.31.png)
- 모분산비 추정량의 확률분포
  - 모분산비는 특정한 분포를 따르지 않기 때문에 s1^2 에 시그마1^2 을 나눠주고 s2^2 에 시그마2^2을 나눠주면 f분포를 따르는데,
  - f분포의 자유도는 s1 제곱의 자유도 n1 -1, 두 번째는 s2 제곱의 자유도 n2 -1 을 따른다.
  - ![스크린샷 2022-04-17 오후 7.35.05](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.35.05-0191937.png)
- 모비율 추정량의 확률분포
  - p 햇과 관련된 분포는 표준정규분포이다.
- 모비율차 추정량의 확률분포
  - 이또한 중심극한 정리에 의해서 표준정규분포를 따른다.
- ![스크린샷 2022-04-17 오후 7.38.08](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.38.08.png)



지금까지 알아본 분포들을 표준화 하거나 변형 함으로써 우리가 잘 알고있는 새로운 다른 분포들을 활용할 수 있다.

그 대표적인게 아래와 같다.



1. 표준정규분포

2. t분포

   - ![스크린샷 2022-04-17 오후 7.42.24](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.42.24.png)

   

3. X1 바 - x2 바 표쥰화

   - 표준정규분포를 따른다.
   - ![스크린샷 2022-04-17 오후 7.42.33](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.42.33.png)

4. 시그마 1 ^2 과 시그마2^2 을 모르는 경우는?

   - 방금 위에서의 시그마1^2 과 시그마2 제곱을 아는 경우에 할 수 있는 것임.

   - 하지만 항상 알려져 있는 게 아니고 알려져 있지 않은 경우가 대부분이다.

   - 따라서 시그마1 제곱과 시그마2 제곱을 모르는 경우는 두 가지 경우로 나눠서 생각할 수 있다. 

   - ##### 모르지만 시그마1 제곱과 시그마 2 제곱을 같다고 하는 경우와 다르다고 하는 경우로 나눠서 생각할 수 있다.

   - 각각의 경우 다른 분포를 가지게 된다.

   - ![스크린샷 2022-04-17 오후 7.44.05](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.44.05.png)

   - 우리가 모수를 모를 때 사용하는게 Sp 를 사용한다. (시그마1^2 과 시그마2^2 을 모를 때)
   - Sp의 p는 pooled를 의미하고 Sp 제곱은 pooled estimate 라고 하며 pool 은 모으다를 의미한다.
   - Sp 제곱은 두 표본 분산들의 가중 평균이라고 할 수 있다.
   - 시그마1 제곱과 시그마2 제곱 대신에 Sp^2 을 대입해서 쓰는데, 이것은 분포는 t분포를 따르고 자유도는 n1 + n2 - 2다.
   - ![스크린샷 2022-04-17 오후 7.48.07](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.48.07.png)

   - 다음은 시그마1 제곱과 시그마2 제곱을 모르는데, 둘이 같다라는 보장이 없을 때, 즉 둘이 다르다고 했을 떄는?
   - 이때는 pooled estimate 가 쓰는 게 아니라 그대로 S1 ^2 과 S2^2 을 그대로 사용할 수 밖에 없다.
   - 그러나 그때는 t분포의 자유도를 따로 찾아야 한다. 자유도를 V 라고 한다면 복잡한 식에 의해서 나오게 된다.
   - v는 복잡한 식에 의해서 소수가 나올 가능성이 큰데 따라서 올림을 해줘서 정수로 자유도를 만들어 준다.
   - ![스크린샷 2022-04-17 오후 7.50.57](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 7.50.57.png)





> 여기까지 점추정량에 대해서 관련된 확률분포 등을 알아봤다.



<hr>

## 최우도추정법(maximum liklihood estimation)



- 우리가 모집단이 어떤 확률 분포를 따르는지는 알고 있지만 구체적으로 모수들을 알지 못할 때, 사용하는 방법

- 관측된 표본 자료를 이용한다.

  - 관측된 표본 자료를 보고 이러한 숫자들이 이러한 값들이 나오려면 모수가 어떤 값이 나오면 될까? 라는 질문에서 출발한다.

- 우도 함수를 정의하게 된다.(우도함수)

  - 관측된 표본 자료를 확률 함수 또는 밀도 함수에 대입을 해서 모든 결합 밀도 함수, 결합 확률 함수를 구한 것을 우도 함수라고 이야기 한다.

  - 우도함수는 관측된 표본자료 x_i 와 모수 세타에 의존하고 있다.

  - 우도함수가 최대가 되는 모수 세타 값을 우리는 얻고자 하는 것.

    - 세타값을 찾을 때 우도 함수가 최대가 되는 세타 값

    - > 우도 함수가 최대값을 갖는 세타의 값을 찾기 위해서는?

    - 우도 함수가 최대가 되는 모수 세타 값을 얻기 위하여 우도 함수를 세타에 대해 미분하는 방법을 사용함.

    - 이때 구한 세타 값을 세타 햇이라고 이야기한다.

    - 





<hr>

## 예제



우도함수에서 값이 최대가 되는 p를 구한다.

우도 함수를 세타에 대해서 미분하고 0으로 놓고 세타 값을 구하는 것이 최우도추정법이다.



그런데 우도 함수는 각가의 확률 함수를 곱하는 것이기 때문에 미분하기가 까다롭다.

그렇다면 똑같은 최대값을 가지는 세타를 얻는데 미분하기 수월하게 하려면 어떤 방법을 택하면 좋은가?

이때 사용하는 방법이 로그

로그함수는 단조증가함수이기 때문에 L(세타) 가 최대가 되기 위해서는 로그(L(세타)) 가 최대가 되어야 한다.

우도함수 L(세타) 에 로그를 취하게 되는데 이를 로그 세타 함수라고 부른다.





1) 최우도 추정량 문제 예제

![스크린샷 2022-04-17 오후 8.03.40](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 8.03.40.png)



f(x_i : p) => p가 주어졌을 때 이항 분포의 확률 함수를 의미한다.



![스크린샷 2022-04-17 오후 8.12.25](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 8.12.25.png)









<hr>





## 모멘트 방법(method of moments)



- 표본자료에 대한 표본모멘트가 확률분포의 이론적 모멘트와 같다고 가정하여 모수를 구함



![스크린샷 2022-04-17 오후 8.14.22](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 8.14.22.png)





![스크린샷 2022-04-17 오후 8.15.45](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 8.15.45.png)

![스크린샷 2022-04-17 오후 8.19.10](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-17 오후 8.19.10.png)



<hr>

## 베이지안 추정(Bayesian estimation)



- 표본 자료와 모수에 대한 사전 정보를 이용해서 모수를 추정하는 방법



![스크린샷 2022-04-20 오후 1.49.30](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-20 오후 1.49.30.png)



포아송 분포에서 사전 정보가 주어졌다.

![스크린샷 2022-04-20 오후 1.53.34](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-20 오후 1.53.34.png)





### 베이지안 추정량 구하기



확률변수 y의 분포에 포함된 모수 세타에 대하여, 세타가 어떤 밀도 함수 h 세타를 가지고 있다고 전제를 하는 경우가 된다.

보통 세타 모수는 상수이기 떄문에 어떤 분포도 없고 밀도 함수가 있을 수 없다.

그렇지만 그 세타가 무슨 값인지 모르기 때문에 사전 정보를 제시를 하고 표본 자료를 이용해서 세타에 대한 추정을 해보자는 취지가 베이지안 추정

모수 세타에 대하여 세타가 어떤 밀도 함수 h 세타를 가지고 있다고 전제한다음 세타에 대한 베이지안 추정을 하게 된다.





![스크린샷 2022-04-20 오후 2.34.17](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-20 오후 2.34.17.png)





![스크린샷 2022-04-20 오후 2.34.31](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-20 오후 2.34.31.png)



pdf 참조

1. 먼저 세타가 주어져 있으니 세타가 주어져 있을 때, y의 확률 함수, 밀도함수를 찾는다. => y의 확률함수 또는 밀도 함수를 g(y|세타)
2. 세타의 밀도 함수를 찾는다. => 예를 들어서, 세타가 표준 정규 분포를 따른다고 한다면 h(세타) 는 표준 정규 분포의 밀도 함수를 알고 사용해야 한다.
3. y와 세타 두 개가 있으니까 두 개의 결합밀도함수를 찾는다. f(y,세타) = g(y|세타)h(세타)
4. y의 주변밀도함수를 찾는다 :  f(y) = f(y,세타) 에 대한 적분
5. 세타 | y 의 사후 밀도 함수를 찾는다.

<hr>



### 예제



#### ![스크린샷 2022-04-20 오후 2.35.19](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-20 오후 2.35.19.png)





진짜 하나도 모르겠음 





<hr>

### 점추정량 판정 기준



#### 일치성



- 표본이 무한대로 커질 때, 추정량이 모수와 일치하는지 아닌지를 확인하는 것
- n이 무한대로 갈 때, 그 추정량이 모수와 일치할 때, 일치성이라고 이야기 한다.
- n이 무한대로가면 표본 평균의 분산은 0이 된다. 분산이 0이기 때문에 변동성이 없다는 것을 의미하고 따라서 하나의 값만 나오게 된다.



### 불편성



추정량의 평균이 모수와 일치할 때, unbiased estimate

표본평균의 경우 E의 x bar 는 뮤이므로 불편추정량이라고 말할 수 있다.



> 성공확률 p hat 또한 불편추정량이라고 할 수 있다. (통계량과 모수의 값이 동일)



### 효율성



불편추정량은 수없이 많지만, 그 중에서도 분산이 가장 작은 것을 efficency estimator

불편추정량 x_bar 의 분산이 평균을 추정하는 추정량 중에서는 최소가 되기 때문에 모평균 추정량 중에서 가장 효율적이다라고 이야기를 한다.









> n-1 로 나누어서 기초 통계량을 구하는 이유
>
> 바로 표본분산이 불편추정량이 될 수 있도록 즉, 시그마 제곱, 우리가 알고자 하는 모분산 시그마 제곱의 불편추정량이 되도록 하기 위해서 표본분산을 구할 때는 n-1 로 나누게 된다.

![스크린샷 2022-04-20 오후 2.53.53](/Volumes/GoogleDrive/내 드라이브/타이포라_source/스크린샷 2022-04-20 오후 2.53.53.png)