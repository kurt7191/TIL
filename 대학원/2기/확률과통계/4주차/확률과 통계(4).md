# 확률과 통계(4)



> 지난 주에는 확률 변수에 대해서 살펴봤다.
>
> 확률 실험을 했으 ㄹ때 표본 공간에 발생 가능한 원소들을 모두 모아둔다고 했는데, 확률 변수는 각각의 원소들을 어떤 숫자로 변환해주는 함수임을 살펴봤다.
>
> 그리고 그렇게 했을 때, 확률 변수가 가질 수 있는 집합을 Rx 라고 정의 했다.
>
> 그런데 Rx 는 집합이기 때문에, 모든 집합은 3 집합 중 하나가 된다.
>
> 그 세 종류의 집합은
>
> 1.  유한집합
> 2. 셀 수 있는 무한 집합
> 3. 셀 수 없는 무한 집합
>
> 이다.
>
> 그랬을 때, 확률 변수 Rx 가 유한 집합이거나 셀 수 있는 무한 집합의 경우 우린는 확률 변수 x를 이산형 확률 변수라고 정의를 내렸다.
>
> 그렇다면 이산형 확률 변수는 가질 수 있는 값들이 0,1,2,3,.. 또는 1,2,3,4,5,6,7,8,9 등등
>
> 값들이 떨어져 있는(이산) 값들이다.
>
> 그랬을 때, 각각의 값에 따라서 확률을 가지고 있는 것.
>
> 즉, x가 1일 때 1/8 이다, x 가 2 일때 3/8 이다. 등등
>
> ex) 동전을 3 번 던졌을 때, 확률 변수 x를 h(앞면)의 수라고 했을 때, 나타나는 경우의 수 일때
>
> x가 0 = f(x) = 1/8 라고 할 때, 이때의 f(x)를 확률 함수라고 정의를 내렸다.
>
> 이산형 확률변수의 특징은 각각의 값을 가질 수 있는 확률들이 정해져 있다. 이 확률들은 0 ~ 1 사이가 되어야 하고, 모든 x 값에 대해서 이 확률들을 모두 더했을 때 반드시 1이 되어야 한다.
>
> 따라서 확률 함수 f(x) 는 이 두 가지 특징을 가졌을 때만 확률 함수라고 한다.
>
> 두 번 째, 그 확률 변수 x가 Rx 를 가질 때 , Rx 가 셀 수 없는 무한 집합의 경우.
>
> 확률 변수 x가 어떤 측정한 값으로 나타나는 실험일 때, 확률변수는 연속형 확률 변수를 가진다고 이야기 한다.
>
> 셀 수 없는 무한대의 원소를 가지고 있기 때문에 특정한 값의 확률을 가지는 경우는 없다.
>
> 그렇게 때문에 연속형 확률 변수의 경우 확률을 구하기 위해서는 어떤 구간 a~ b 사이의 확률을 구하는 형식으로 나타난다.
>
> 그때 x값에 대한 확률 변수의 빈도 내지는 밀도라고 하는데, 밀도 함수 f(x) 라고 하고, 밀도 함수 f(X) 는 반드시 양의 함수가 되어야 한다. 그래야 어떤 구간에 대해서 확률을 구할 때 그 값이 0 ~ 1 사이의 값을 가진다.
>
> 밀도 함수가 되기 위해서의 조건
>
> 1. f(x) 는 모든 x에 대해서 양의 함수가 되어야 한다.
>
> 2. 전 구간 -무한대 ~ +무한대 에 대한 f(x) 적분 값은 1이다.
>
>    따라서 특정 구간의 확률도 0 ~ 1사이의 값을 가진다.
>
> 그래서 확률 함수도 f(x), 밀도 함수도 f(x)를 사용하기 때문에 때로는 혼돈할 수 있지만, 확률 함수를 나타내는 조건, 밀도함수를 나타내는 조건들을 연습문제를 통해서도, 예제를 통해서도 확인해봤기 때문에 충분히 이해를 잘 할 수 있다.
>
> 다음에 우리가 다뤄봤던 내용은 분포함ㅅ구
>
> 분포함수는 누적 확률함수.
>
> 이때  이산형 확률변수의 분포함수는 계단형 함수다.
>
> 그 계단의 높이가 곧 확률 함수가 된다.
>
> 분포함수와 확률 함수, 분포함수와 밀도 함수는 1대1 대응 관계
>
> 어느 한쪽만 알아도 구할 수 있다.
>
> 다음은, 확률 변수는 각각의 값들에 대해서 확률이 또는 빈도가 흩어져 있기 때문에, 확률 분포의 중심이 어디냐를 찾는다.
>
> 그게 확률 변수의 평균이다. (EX)
>
> 분산은 EX로부터 얼마만큼 흩어져 있는지의 척도, var(x) 는 ex^2 - 평균(뮤)^2이다.
>
> 확률변수의 특징
>
> 연속형이든 이산형이든 어떤 함수로 표현할 수 있고, 그렇게 확률 변수의 함수로 나타냈을 때, 새로운 확률변수는 기존 확률 변수가 이산형이면 새로운 변수도 이산형, 기존 변수가 연속형이면 새로운 함수도 연속형 변수다.



오늘은 이변량 확률변수에 대해서 살펴볼 예정이다.

지난 시간, 이산형 확률변수, 연속형 확률변수에 대해서 살펴볼 때, X or Y 만 살펴봤다.(일변량만 살펴봤다.)

하지만 때로는 두 개의 변수를 동시에 고려할 때가 있다. (다 변량)

확률 변수 x와 y를 동시에 고려하는 경우가 있다.

(Ex 옷을 구매하러 가게에 왔을 때, 사이즈 하나만 보기도 하지만, 셔츠를 구매하려고 할 때, 목 둘레, 팔 길이, 사이즈 등등의 여러가지 요소들을 동시에 고려한다. 이때의 두 개의 변수만 동시에 고려하는 것을 이변량 확률변수라고 하고 오늘은 이변량 확률변수의 특징들에 대해서 살펴볼 예정.)



<hr>

## 오늘 배울 내용 정리



##### 이변량 확률변수



- 두 개의 확률 변수를 동시에 고려하는 것
- (X, Y) 로 표기
- 이때 x와 y는 두 개다 동시에 이산형 확률 변수이거나 연속형 확률 변수인 경우만 고려한다.



##### 오늘 배울 내용



> 이변량 확률 변수
>
> 결합확률함수, 결합밀도함수, 주변확률함수, 주변밀도함수



<hr>



## 이변량 확률 변수



### 이변량 확률 변수 정의



두 개의 확률 변수를 동시에 고려할 때 확룰 변수 x,y 가 어떤 특성을 갖는지 알아볼 것

=> 이 때 두 변수는 동시에 연속형이거나 이산형이다.



### 확률 변수 x,y 가 모두 이산형 확률 변수인 경우

ex) x: 감염자 수, y: 완치된 환자 수 



### 확률 변수 x, y 가 모두 연속형 확률 변수인 경우

ex) x :  광고비 y : 매출액, x : 키 y : 몸무게



<hr>



### 결합확률함수

(주변 확률 함수 포함)



#### 확률변수 x와 y가 모두 이산형 확률변수인 경우

조건

>  f(x,y) = p(X = x, Y = y)
>
> 0<=f(x,y)<=1
>
> 시그마시그마f(x,y) = 1 (다 더했을 경우 1)



결합 x,y 는 동시에 고려할 때이지만, 때로는 x만의 움직임, y만의 특성을 살펴볼 필요가 있다.

그랬을 때, 결합확률함수로부터 x만의 주변 확률 함수를 구할 수 있는데, 그 때는 y에 대해서 모든 값들을 더하는 것,

그리고 y의 주변확률함수도 x에 대해서 다 더하면, 즉 g(X) 는 y 값은 어떤 값을 가지던 상관하지 않고 단지 x가 0이냐 1이냐, 2이냐... 그럴 때 어떤 확률들을 가지는지 살펴보는게 주변 확률함수다.

예제를 통해서 이해해보자.

pdf파일 참조



##### 결합확률함수 활용 예제

> 주머니 안의 공의 수
>
> => 파란색 3, 빨간색 2, 초록색 3 총 8개
>
> X = 파란색 공의 수, Y = 빨간색 공의 수
>
> R(x,y) = {(0,0), (0,1), (0,2), (1,0),(1,1)(2,0)}
>
> f(x,y) = (3,x), (2,y),(3,2-x-y) / (8,2)
>
> ex)
>
> (3,2)/28
>
> 3C2 = 3! / 1 ! * 2! => 3 * 2 * 1 / 1 * 2 * 1 = 3
>
> 
>
> nCr = n! / (n-r)!r!



x에 대한 주변 확률 함수 (y 는 0이던1이던2이던 상관없이 x가 어떤 수일 때의 확률을 모두 더한다.) (g(x))

y에 대한 주변 확률 함수(x가 0이던 1 이던 2이던 상관없이 y가 어떤 수일 때의 확률을 모두 더한다.)

(h(y))



![스크린샷 2022-03-27 오후 3.07.42](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 3.07.42.png)



이 예제를 통해서 결합 확률 함수와 주변 확률 함수까지 살펴봤다.



또 다시 예제를 살펴보자.

##### 활용 예제 2



1번 : g(x), x의 주변확률함수를 구하라.

이산형일경우 g(x) 는 모든 y에 대해서 f(x,y) 를 더하는 것.



![스크린샷 2022-03-27 오후 3.11.24](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 3.11.24.png)



2번 : h(y) : y의 주변확률함수를 구할.

h(y) 는 모든 x에 대해서 f(x,y) 를 더하는 것.



![스크린샷 2022-03-27 오후 3.13.24](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 3.13.24.png)



#### 확률변수 x와 y가 모두 연속형 확률변수인 경우

=> 결합밀도함수



조건

> 모든 x,y 에 대해서 f(x,y) 는 양의 함수
>
> 모든 구간에 대해서 (x,y) 이중적분한 값은 반드시 1이여야 한다.
>
> x 는 a ~ b사이 y 는 c ~ d 사이라고 했을 때, 이중 적분을 통해서 확률을 계산한다.



g(x) f(x,y) 를 y에 대해서 적분

h(y) f(x,y) 를 x에 대해서 적분



##### 결합밀도함수 예제

정답 : 13 / 160



![스크린샷 2022-03-27 오후 3.18.15](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 3.18.15.png)



##### 주변밀도함수 예제

x의 주변 밀도 함수



![스크린샷 2022-03-27 오후 3.22.03](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 3.22.03.png)





y의 주변 밀도 함수



![스크린샷 2022-03-27 오후 3.26.04](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 3.26.04.png)

<hr>

### 공분산



확률변수가 2개 이상일 때 존재



확률변수 x와 y가 각각의 평균 Ex와 Ey로부터 얼마나 흩어져 있는지의 척도



##### 공분산 예제



g(x) 와 h(y) 를 찾아낸 다음에 계산을 해야한다.





![스크린샷 2022-03-27 오후 4.25.30](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 4.25.30.png)





### 공분산의 특징



공분산은 단위에 민감하다.

두 변수의 공분산을 구할 때, 각 변수의 단위가 다르면?

단위가 바뀌면 공분산의 값이 바뀜



cov(ax, by)

ex). 키, 몸무게 => cm -> m a는 1/100

 kg -> g 로 변환, b는 1000



공분산만 가지고 두 확률변수 x ,y 의 상대적 흩어짐을 나타내기에는 부적절한 면이 있다.

잠시 후 이 부분을 해결할 예정







![스크린샷 2022-03-27 오후 4.36.48](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 4.36.48.png)





![스크린샷 2022-03-27 오후 4.36.19](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 4.36.19.png)



<hr>



### 확률변수의 독립성



두 사상 a,b 가 있을 때, 사상 a,b 가 독립이면

P(AB) = P(A)P(B), 사상 A,B 는 독립이다.



사상 a와 b가 독립이 되면 조건부 확률이 필요없다.



그렇다면 확률변수 X,Y 의 관계에 대해서 알아보자

만일 확률변수 x,y 가 독립이라면,

f(x,y) = g(x)h(y) => 주변함수의 곱이 된다.

이럴 때, 확률변수 x, y 는 독립이라고 한다.



##### x와 y가 독립인지 아닌지에 대한 확인은 결합확률 혹은 결합밀도함수가 각각 주변확률함수 또는 주변밀도함수의 곱인지를 확인한다.



x1 ~ xn 까지 상호독립이라고 한다면,

각각의 주변확률함수의 곱으로 나타낼 수 있다.

그리고 만일 주변확률함수로 나타낼 수 있다면 각각 변수들이 독립이라고 할 수 있다.



##### EXY =  E(X)E(Y) 가 된다.

##### cov(x,y) = 0

##### 따라서, 확률 변수 x,y 가 독립이면 cov(x,y) = 0 이다.



그렇다면 cov(x,y) 가 0이라면 x,y 는 독립일까? 라고 했을 때는 아니다.

즉 일방향이다.

x,y 가 독립이면 반드시 cov =0 이다.

때로는 cov = 0으로 나타나지만 x,y 가 독립인지는 알 수 없다.

그렇다면 cov(x,y) = 0 이 나왔을 때, 두 변수가 독립인지는 어떻게 알아내는가?

이때 f(x,y) = g(x)h(y) 인지 확인해야 된다.



만일 확률 변수 x,y 가 독립이면, var(x+-y) = var x + var y 가 된다.

왜냐하면 확률 변수 x,y 가 독립이기 때문에 cov(x,y) = 0 이 되고 따라서 +-2cov(x,y) 가 사라지기 때문에 var x + var y 만 남는다.

본래는 아래의 식이다.

![스크린샷 2022-03-27 오후 4.36.19](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 4.36.19.png)



이렇게 서로 확률 변수상 독립이다라는 조건은 계산할 때 굉장히 유리하다.



<hr>



### 확률변수 X와 Y의 선형 결합



U = aX + bY



##### pdf 확인



<hr>

## 상관계수(correlation coefficient)



확률변수 X의 증감에 따른 확률변수 Y의 증감 정도를 나타내는 척도



식은 pdf 참조 =>cov(x,y) 를 각각의 표준편차로 나눠주게 된다.



ex) 키와 몸무게의 상관관계를 수치로 잴 때, cov(x,y) 를 구할 때는 단위가 살아있다.

그렇지만 var x의 단위가 있고 var y 가 단위가 있는데, 그 단위들하고 cov(x,y) 의 단위들이 서로 상쇄되고 없어진다.

##### -1 <px,y< 1 단위는 없어진다.



Cov(x,y) 는 단위에 민감한데, 이때 문제가 되는 걸 상관계수를 통해서 해결할 수 있다. (단위가 없는 값이기 때문에)



> 왜 상관계수 로 x,y 는 -1 ~ 1의 값을 가지는가?
>
> 관련 증명식은 pdf 파일에 있음
>
> 결국 -1 ~ 1사이로 상관계수는 나옴을 나타내고 있다.



##### 상관계수의 의미는?



정비례의 관계 (0<px,y<1)

무상관의 관계 (px,y = 0)

반비례의 관계 (-1<px,y<0)



그렇다면 px,y = 1 이면 100%, 완벽한 정비례

Px,y = -1 이면 완벽한 반비례



이때 var(x)나 var(y) 가 0이 되는  경우 상관계수는 정의되지 않는다.

##### 이 경우는 상관계수가 1 일때와 -1일때와 구분된다. 명심.



<hr>

##### 확률변수 x,y 가 독립인지에 대한 유무를 이용해서 상관계수를 쉽게 구할 수 있다.

g(x) 와 h(y) 를 구하고, 두 주변확률함수의 곱이 f(x,y) 와 동일하면 확률변수 x,y는 서로 독립이라고 이야기 할 수 있고,

상관관계를 구하는 식의 분자인 cov(x,y) 가 값이 0이 되기 때문에 상관계소 로 x,y (px,y) 는 0이 된다.





![스크린샷 2022-03-27 오후 6.31.43](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 6.31.43.png)







![스크린샷 2022-03-27 오후 6.32.21](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 6.32.21.png)



<hr>

##### 다음 예제



cov 와 var 관계를 살펴보는 예제



![스크린샷 2022-03-27 오후 6.35.28](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 6.35.28.png)



<hr>

##### 다음 예제



x,y 의 결합확률함수를 표로 보여주고

cov(x,y)

corr(x,y)

x,y 서로 독립인지 물어보는 문제



![스크린샷 2022-03-27 오후 6.43.20](/Users/jang-eunjun/Desktop/TIL/대학원/2기/확률과통계/4주차/이미지/스크린샷 2022-03-27 오후 6.43.20.png)

