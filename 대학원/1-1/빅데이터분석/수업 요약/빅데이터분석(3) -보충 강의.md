# 3주차 빅데이터 분석



### 전통적인 통계기반 데이터 분석 기법



##### 통계학과 데이터마이닝의 관계란



구분지을 수 없다



##### 유사성 모형



- 하나의 프로토타입을 비교하는 것.
  - 하나의 이상적인 형태를 정해놓고 점수를 부여할 대상과 비교해서 거리를 재어 점수를 부여한 것
  - 기본적으로 프로토타입(이상적 모형), 유사성 함수(프로토타입과 대상과의 거리를 재는 함수) : 프로토타입 + 유사성 함수 = 유사성 모델
- 예시) 허드슨 나이아가라 스토브 회사(H&N) , 난로를 파는 회사
  - 뉴욕주에서 난로르 판매하고 있었는데 버몬트 주에도 사업을 확장하고 싶었다. CEO는 기존의 뉴욕주의 데이터를 활용해서 새로운 곳의 판매점의 좋은 위치를 선택하려고 한다.
    1. 이상적인 타운을 정의
    2. 그 이상적인 타운과 각 타운의 거리를 비교하려고 한다.
    3. 목표변수는 h&n 장작 난로 제품의 침투도(얼마나 많이 사용되고 있는지)
  - 이상적인 타운을 정의하기 위해서 침투도가 높은 지역과 낮은 지역을 구분할 수 있는 속성을 찾아야만 한다. 찾은 속성을 토대로 이상적인 타운을 정의내릴 수 있다. -> 이상적인 타운 정의 -> 각 타운과 이상적인 타운의 거리 비교



1단계

- 무엇이 침투도가 높은 타운과 낮은 타운을 구분하는가?
  - 상위 1/3 하위 1/3 을 따로 뽑아낸다
  - 이 두 집단간의 차이가 뭔지 살펴본다.
  - 위의 예시에선 농업종사 비율, 다세대 주택 비율, 주택 가격 중간값이 차이가 난다.

2단계

- 침투도가 높은 타운과 낮은 타운을 구분하는 속성을 이용해서 이상적인 타운을 정의 내린다

3단계

- 위에서 이상적인 타운을 정의 내린 속성을 z-value 로 정규화 시킨다.
- 각 타운들의 위의 속성들도 z-value 로 정규화 시킨다.
- z값에 기초하여 유클리디안 거리를 사용해서 각 타운과 이상적인 타운과의 거리를 잰다. (거리가 가까울수록 이상적인 타운이라고 할 수 있음)



유사성 모형의 단점



유클리디안 거리를 통해서 거리가 가까운 곳이 침투도가 높지만은 않음

거리가 가까워도 침투도가 높을수도 있고 낮을수도 있음

이것이 유사성 모형의 단점



##### 테이블 참조 모형



1단계

- 대상을 특정한 레이블 또는 키에 할당
  - 차원의 선택
    - 입력변수들을 선택해야한다. 
    - 서로 독립적인 변수들을 선택하는 게 좋다.
    - 만들어진 차원에 레코드 수가 너무 적으면 좋지 않다.
  - 차원의 분할
    - 나이라는 차원이 있으면 나이대별로 나누어 범주화 시켜서 이산화
    - 주라는 차원이 있으면 모든 주를 다 사용하는 게 아니라, 비슷한 주끼리 합쳐서 사용하는 게 이득.

2단계

- 훈련 데이터로부터 점수 만들기

  - 차원이 정해졌다면, 정해진 차원에 의해서 셀들이 정의된다.
  - 만일 목표변수가 수치형일 경우에는 각 셀의 평균이 점수가 된다.
  - 만일 목표변수가 범주형일 경우에는 각 셀에서 클래스의 비율이 점수가 된다.
  - 주의! 그런데 만일 차원에 의해서 정의된 셀들 안에 레코드 숫자가 적을 시에는 차원 축소를 하거나 차원의 구간을 줄여서 셀들을 합쳐 숫자를 늘려야 한다.

  

  

  

  ##### 테이블 참조 모형의 가장 대표적 모델 RFM 모형

  

  최근성(Recency), 빈도(Frequency), 금액(Monetary)

  

  최근에 구입한 소비자에게 점술 줌

  얼마나 우리 제품을 구매하느냐에 빈도 점수 줌

  우리 회사에서 얼마나 제품을 구매했는가?

  

  최근성 변수, 빈도 변수, 금액 변수 각각 구간을 나눔.

  각각의 구간의 갯수에 따라 셀 갯수가 결정이 됨

  어떤 고객은 최근성, 빈도, 금액에 따라서 어떤 셀에 결정이 됨

  그 고객이 얼마나 이탈 확률이 높은지 구매 확률이 높은지 셀별로 확인할 수 있다.

  

  ##### 나이브 베이지안 모형

  

  테이블 참조  모형에서 만일 변수의 구간을 각각 10개로 만든다면 만들어지는 셀의 개수도 10의 n승이 될것이다. 만일 4차원까지 만들게 되면 셀이 10000개가 될텐데, 기존에 우리가 가지고 있는 레코드들이 이 만개의 셀에 골고루 포함되지 않을 것이다. 따라서 어떤 셀은 빈공간을 가지고 있을텐데, 이러한 점이 문제.

  

  나이브 베이지안은 이러한 문제점을 해결하려고 한다.



나이브 베이지안 모형은 베이즈 법칙에 근거한다.

먼저 베이즈 법칙과 확률, 오즈 개념에 대해서 알고 넘어가야 한다.



- 베이즈 법칙 : P(A|B) = P(A)P(B|A) / P(B)



- 확률과 오즈 : 오즈란 P가 일어난 확률가 P가 일어나지 않을 확률의 비율





본격적으로 나이브 베이지안 알아보자



(NAIVE) : 입력변수(독립변수)들이 독립이라고 가정한 것이다. (사실은 독립이 아닌겠지만)



X => 독립변수들의 모음이라고 치자. X1, X2 ... Xn.

구하고 싶은 것은 P(C_k|X) 이다.

이는 X입력분수일 때 C_k 클래스에 속할 확률이다. 예를들어서 C_K는 C0, C1 일수도 있으며 이는 X입력변수일 때 C0 일 확률 혹은 C1일 확률을 나타낸다.



각 변수들이 모두 독립이라고 가정한다면, 어떤 변수의 값이 어떤 값일 때, C0에 속할 확률 각각을 모두 곱하고 P(C_k) 를 마지막에 곱하면 확률이 나온다.



테이블 참조 모형과의 비교



공통점 : 어떤 입력변수들 값일 때 어떤 클래스에 속할 확률을 구한다는 점에서 비슷하다.



차이점 :  참조모형은 변수들 간의 상호작용을 잡아낼 수 있는 반면에 

나이브 베이지안은 독립이라고 봤다.



또한 테이블 참조모형 같은 경우, 입력변수의 결합에 관한 해당 셀의 레코드들이 존재하지 않을 때는 아무런 정보도 줄 수 없다.

하지만 나이브 베이지안은 어떤 변수의 값이 정해졌을 때, 각 클래스에 속할 확률을 구할 수 있기 때문에, 레코드 정보가 없더라고 확률을 구할 수 있다.



##### 선형 회귀 모형



R2 => Y = AX + B 가 있을 때 어떤 X값에 따른 Y값을 이야기 할 수 있을 것.

본래 회귀식이 없다면 Y평균으로 측정을 했을 것.

그렇다면 Y평균과 실제 데이터 사이에 간극이 존재.

이때 Y = AX + B 식은 Y평균보다는 실제 데이터에 대해서 더 잘 설명했을 것

Y평균과 실제 데이터의 변량이 있을 때, 그 간극의 몇 %를 더 설명했는지 R^2가 나타내준다.



하지만 절대적으로 좋은 R2점수를 알 수 없다.

즉, 절대적인 기준이 없다.



GLOBAL 패턴을 찾지 LOCAL 패턴을 찾는게 아님 (데이터 전체의 패턴이지, 어떤 구간의 패턴을 찾는 게 아니다.)



##### 다중 회귀 분석



여러 변수들이 있는 회귀 분석



각 변수가 P-VALUE 0.05 보다 작아야 한다. 그래야 유의미한 변수



하지만 회귀분석의 모양이 직선이 아니라 곡선의 형태를 가질 수 있다. (산모양)

그러면 계수가 - 부호임에도 불구하고 어떤 지역은 양의 관계를 가질 수 있다.



이를 해결하기 위해서 변수를 변환하거나 거리변수를 대체한다.

또는 그 변환점을 나누어서 따로 따로 부분 회귀 분석을 한다.



이를 통해서 회귀분석의 지역 효과를 대처할 수 있다.



다중회귀분석 변수의 선택

- 전진선택
  - 설명력이 높은 변수를 하나씩 추가하는 방법
- 단계선택
  - 전진선택법과 비슷하지만 넣을 때, 기존 것을 뺄수도 있고 넣을 수도 있다.
- 후진제거
  - 다 포함시켰다가 쓸모없는 것을 단계적으로 빼는 것.

