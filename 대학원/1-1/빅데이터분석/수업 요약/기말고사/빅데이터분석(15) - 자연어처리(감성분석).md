# 빅데이터분석(15) - 자연어처리(감성분석)



> 감성분석
>
> 감성분석 실습



> 1. 사전기반 감성 분석과 실습
>
> - VADER 를 이용한 감성 분석
> - 로지스틱 회귀분석을 이용한 감성 분석
>
> 2. 기계학습 기반 영어 감성 분석
>
> - CNN을 활용한 감성 분석
>
> 3. BERT를 활용한 감성 분석

<hr>



# 감성분석



- 오피니언 마이닝
- 공개된 정보 원천들을 자동으로 읽어서 사람들이 어떤 것에 대하여 어떻게 느끼고 있는지를 판단.
- 활용
  - 상품과 콘텐츠 감성 분석
  - 정책 여론 분석
  - 영화 감성 분석을 활용한 흥행 예측
  - 기업 뉴스를 활용한 주가 예측
  - 기업 및 브랜드 감성 분석



<HR>

## 감성분석 방법

1. 사전 기반 감성 분석
   - Lexicon - based 접근법
   - 긍정단어 부정단어와 관련된 단어 사전을 사전에 만들고 새로 문서가 들어오면 
   - 그 문서를 tokenize 해서 문서에 나온 단어들의 긍정단어 개수와 부정단어 개수를 카운트.
   - 장점은 훈련이 따로 필요가 없음.
   - 단점은 사전의 성능에 크게 좌지우지됨.
2. 기계학습 기반 감성 분석
   - 가지고 있는 문서 feature 추출, 그리고 label(정답)을 미리 가지고 있음.
   - feature 와 label 을 여러 개 머신러닝 알고리즘에 주면 긍정이나 부정을 분리하게 된다.
   - 기존의 분류모델에 사용할 수 있다.
   - 기존에 내가 알던 분류모델 (cnn/rnn 제외) 은 문서를 미리 dtm 으로 전환하고 이를 활용하여 분석함, cnn/rnn 은 다른 방식으로 extraction 한다.



<hr>

## 다범주 감성 분석



일반적으로는 긍정, 중립, 부정

하지만 기쁨 슬픔, 화남, 공보, 슬픔 역겨움 등등으로 나누는 게 다범주 감성 분석임.





## 다차원 감성 분석

Multi- Aspect -Sentiment Analysis



회사를 판단할 때 단순 고객의 긍정,부정 감정만 활용한다면 제한적일 수 밖에 없다.

예를 들어서 핸드폰의 성능에는 기능, 디자인, 가격 등등이 있을텐데, 이때 한 대상에 대해서 다양한 관점으로 판단하는 것을 의미함.



<hr>

### 실습



VADER(사전기반 감성분석), 로지스틱 회귀분석(기계학습 기반 감성분석)





<HR>

## Text 감성분석 by CNN



### 구조



1. 일단 하나의 단어를 숫자로 매핑, 그리고 이걸 다시 N차원으로 매핑

   즉, 하나의 단어가 N차원의 벡터로 표현이 된다.

   (벡터로 한 단어를 표현한다.)

2. 하나의 문서에는 여러 단어들이 들어가 있는데 이를 모두 벡터화해서 표현하면 

   N * M 의 표가 완성이 된다. (2차원)

   즉 하나의 문서(REVIEW)는 2차원이라고 할 수 있다.

   하지만 우리는 문서가 여러 개이기 때문에 결국 INPUT 은 3차원이다.

   (이미지는 3차원)

3. 그러면 합성곱(CONVOLUTIONAL FILTER) 필터의 크기는 어떻게 될까?

   2차원 리뷰의 가로 크기 N은 그대로, 세로는 4 ~ 8 등등 임의 숫자임

   이미지 합성곱 계산 경우에는 수평,수직으로 필터가 움직였지만, 텍스트 분석에서는

   수직으로만 합성곱 필터가 내려간다.

   

   세로가 4일때의 의미는 어떤 단어들이 4개 연속으로 나올 때의 패턴을 계산함을 의미한다.

   5개면 5개.

4. 합성곱 계산이 완료가 되면 수직으로 벡터가 하나 나온다. 이 수직 벡터의 크기는 세로 크기에 따라서 달라진다. (합성곱 계산이 수직으로만 이루어지기 때문에 수직 벡터가 나옴)

5. 이렇게 나온 것 (수직벡터) 중에서 MAX POOLING 해서 가장 큰 값만 추출하여 결합

6. SOFTMAX



## cnn 감성분석 실습



파이썬 파일 참고 (거기에 설명도 주석으로 적어둠)









```python
```























